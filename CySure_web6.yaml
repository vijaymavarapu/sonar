pipeline {
    agent any
    stages 
    {
        stage('Git Checkout') 
        {
            steps
            {
                script {
                            git branch: 'master',
                            url: 'https://Raju.Gupta:6daofdqjvc2nbpocbvojl556ctfpnbp24sdzgydvaomfx7h2cfvq@dev.azure.com/devopsbricks/Sandbox/_git/ISP'
                        }
            }
        }
        stage('Build') 
        {          
            steps 
            { 
                script 
                {    
                    try 
                    {           
                        //dir("ISPWebApi/Dockerfile"+"/") 
                        //{
                        //sh 'docker image build -t acrcyient.azurecr.io/devops-platform-api2:${BUILD_NUMBER} -f ./ISPWebApi/Dockerfile .'

                        //sh 'docker image build -t rajugupta8019/myinfra-1:${BUILD_NUMBER} -f ./ISPWebApi/Dockerfile .'


                            sh "sudo docker build -t rajugupta8019/myinfra-1:${BUILD_NUMBER} -f ./ISPWebApi/Dockerfile ."

                       // }   
                    } 
                    catch (e) 
                    {
                        echo "An error occurred: ${e}"
                            sh "ls -l"
                    }
                }
            }
        }
         
        stage('Login to Docker Hub') 
        {      	
            steps
            {                       	
	                sh 'sudo docker login -u raju.gupta@cyient.com -p P@ssword12345'    
                    // sh 'sudo docker login -u raju.gupta@cyient.com -p P@ssword12345'    
	                echo 'Login Completed'      
            }   

        }  
        stage('Push') 
        {
            steps 
            {
                    sh "sudo docker push rajugupta8019/myinfra-1:${BUILD_NUMBER} "
                    // sh "sudo docker push rajugupta8019/latest"

                    
            }
        }    
    }
}

 